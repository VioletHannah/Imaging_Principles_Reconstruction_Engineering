# 第一次作业 傅里叶反变换重建增强实验报告

## 实验步骤

1. **图像预处理**  
   读取 `phantom.bmp`，灰度化并归一化到 [0,1]，调整尺寸为 (128 * 128\)。

2. **投影生成（正弦图）**  
   以 **1° 步进** 生成从 **0°–179° 共 180 次投影**。  
   每次将图像旋转对应角度后按列求和，得到平行投影值。  
   所有角度的投影按列拼接形成正弦图（sinogram）。

3. **傅里叶域重建**  
   基于中心切片定理：  
   - 对每个角度的投影信号进行一维傅里叶变换；  
   - 将频域结果按照角度映射到二维频谱平面；  
   - 通过插值构建完整的二维频谱；  
   - 对频谱进行逆二维傅里叶变换，得到重建图像。

4. **二维频域滤波增强**  
   为减弱频域截断效应与高频噪声，考虑两种滤波方案：
   - **Hann窗函数**（Hann）  
   - **Hamming窗函数**（Hamming）  
5. **误差评估与结果保存**  
   - 计算原图与重建图之间的 **均方误差（MSE）**；  
   - 绘制三种方法的重建图像对比；  
   - 保存正弦图、重建图像、MSE结果等文件。

---

## 实验结果

### 图片展示

正弦图（180 次投影）：`hw1_enhanced_results/sinogram.png`  
![](./hw1_enhanced_results/sinogram.png)

重建结果对比图：`hw1_enhanced_results/comparison.png`  
![](./hw1_enhanced_results/comparison.png)

---

### MSE结果

| 滤波类型 | 窗函数 | MSE |
|----------|:-------:|----:|
| 无窗滤波 | none | 0.001264 |
| Hann窗滤波 | hann | 0.000945 |
| Hamming窗滤波 | hamming | 0.000923 |


---

## 主要结论

- 傅里叶反变换法能较好地实现CT图像重建，但直接使用无窗滤波的结果存在明显的振铃效应与高频噪声。  
- 使用 **Hann** 与 **Hamming** 窗函数能在保持边缘清晰度的同时有效抑制噪声与伪影。  
- 相比 Hann 窗，Hamming 窗具有更平滑的频谱过渡，因而在本实验中获得最小的MSE。  
- 窗函数在傅里叶重建中的作用类似于带限滤波，可改善频谱插值误差，提高重建稳定性。  
---

## 输出文件清单（`hw1_enhanced_results/`）

- `sinogram.png` — 正弦图（180 投影）  
- `reconstructed_none.png` — 无窗重建结果  
- `reconstructed_hann.png` — Hann窗重建结果  
- `reconstructed_hamming.png` — Hamming窗重建结果  
- `comparison.png` — 原图与三种重建结果对比图  
- `mse_summary.txt` — 不同窗函数的MSE数值汇总  
