# 第三次作业 算术迭代重建实验报告

## 实验步骤

1. 原图：
phantom.bmp (灰度化并归一到 [0,1])

2. 投影：
根据投影公式计算每个像素在指定角度旋转坐标系下的横坐标即s坐标，对每个s坐标处的projection累加像素值。

  > 投影角度: [0, 9, 18, 27, 36, 45, 54, 63, 72, 81, 90, 99, 108, 117, 126, 135, 144, 153, 162, 171] (共 20 次)

3. 算术迭代重建:
三个循环，最外层循环遍历iteration个迭代周期，第二层循环遍历20个投影角度，最内层循环遍历一个角度下的diag_length条射线。
三种方法区别在于重建图像的更新。

  - ART：在最内层循环内更新，即每条射线更新一次重建图像。
  - SART：在第二层循环内更新，即每个角度更新一次重建图像。
  - SIRT：在最外层循环内更新，即遍历所有角度后更新一次重建图像。

4. 计算重建误差并比较

5. 尝试不同松弛系数和迭代次数，观察对重建结果的影响

## 部分实验结果展示
![初始图片](./lambda_0.6_iter_50/orig_resized.png)

![](./lambda_0.6_iter_50/sinogram.png)

![使用ART方法重建后的图片](./lambda_0.6_iter_50/recon_ART.png '使用ART方法重建后的图片')
![使用SART方法重建后的图片](./lambda_0.6_iter_50/recon_SART.png '使用SART方法重建后的图片')
![使用SIRT方法重建后的图片](./lambda_0.6_iter_50/recon_SIRT.png '使用SIRT方法重建后的图片')

## MSE
![](MSE.png)

| 方法 | LAMDA | iteration | MSE |
|------|-------|-----------|-------------|
| ART | 0.5 | 5 | 0.00164063 |
| ART | 0.6 | 5 | 0.00159919 |
| ART | 0.7 | 5 | 0.00157838 |
| ART | 0.6 | 10 | 0.00157323 |
| ART | 0.6 | 20 | 0.00151035 |
| SART | 0.5 | 5 | 0.00164068 |
| SART | 0.6 | 5 | 0.00159928 |
| SART | 0.7 | 5 | 0.00157850 |
| SART | 0.6 | 10 | 0.00157398 |
| SART | 0.6 | 20 | 0.00151040 |
| SIRT | 0.5 | 5 | 0.01600854 |
| SIRT | 0.6 | 5 | 0.01389841 |
| SIRT | 0.7 | 5 | 0.01233744 |
| SIRT | 0.6 | 10 | 0.00827922 |
| SIRT | 0.6 | 20 | 0.00443983 |
| SIRT | 0.6 | 100 | 0.00163314 |

### ART 方法

| LAMDA | iteration | MSE |
|-------|-----------|-------------|
| 0.5 | 5 | 0.00164063 |
| 0.6 | 5 | 0.00159919 |
| 0.7 | 5 | 0.00157838 |
| 0.6 | 10 | 0.00157323 |
| 0.6 | 20 | 0.00151035 |

### SART 方法

| LAMDA | iteration | MSE |
|-------|-----------|-------------|
| 0.5 | 5 | 0.00164068 |
| 0.6 | 5 | 0.00159928 |
| 0.7 | 5 | 0.00157850 |
| 0.6 | 10 | 0.00157398 |
| 0.6 | 20 | 0.00151040 |

### SIRT 方法

| LAMDA | iteration | MSE |
|-------|-----------|-------------|
| 0.5 | 5 | 0.01600854 |
| 0.6 | 5 | 0.01389841 |
| 0.7 | 5 | 0.01233744 |
| 0.6 | 10 | 0.00827922 |
| 0.6 | 20 | 0.00443983 |

## 最优结果排名

| 排名 | 方法 | LAMDA | iteration | MSE |
|------|------|-------|-----------|-------------|
| 1 | ART | 0.6 | 20 | 0.00151035 |
| 2 | SART | 0.6 | 20 | 0.00151040 |
| 3 | ART | 0.6 | 10 | 0.00157323 |
| 4 | SART | 0.6 | 10 | 0.00157398 |
| 5 | ART | 0.7 | 5 | 0.00157838 |

## 结论
- 使用简单的旋转-列和近似更新实现的 ART/SART/SIRT 能恢复一些结构，但细节和对比度有限，主要原因在于：
  1. 投影仅 20 个角度，角采样稀疏，信息不足导致条纹/模糊。 增加投影角度后，误差显著下降。结果见 result_5deg 文件夹。
  2. 使用的是非常粗糙的离散射线模型（每条射线沿列平均分配误差），与真实几何或精确的路径权重相比有偏差，后者计算量巨大。
  3. 迭代次数较少且没有额外正则化，容易欠拟合或噪声放大。

- λ 的微调（增大）可以改善 MSE，改进有限。
- SIRT 通常更稳定，但收敛很慢。

## 文件列表
每个输出文件夹命名方式示例out_dir='lambda_0.7_iter_5'，里面包含以下图片和重建误差结果 mse_result.txt
- orig.png 原始图片
- sinogram.png 投影图片
- recon_ART.png 使用ART方法重建得到的图片
- recon_SART.png 使用SART方法重建得到的图片
- recon_SIRT.png 使用SIRT方法重建得到的图片
